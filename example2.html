<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <!-- ApexCharts 라이브러리 -->
  <script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>
</head>
<body>
  <!-- 차트를 표시할 영역 -->
  <div id="chart"></div>

  <script>
    fetch('301.json')
      .then(response => response.json())
      .then(jsonData => {
        // category가 "Issued"인 데이터
        const issuedData = jsonData
          .filter(item => item.category === 'Issued')
          .map(item => [ item.time, item.supply ]);

        // category가 "Forecasted"인 데이터
        const forecastedData = jsonData
          .filter(item => item.category === 'Forecasted')
          .map(item => [ item.time, item.supply ]);

        const options = {
          chart: {
            type: 'line',
            height: 450,
            toolbar: {
              show: false
            },
            zoom: {
              enabled: false
            }
          },
          series: [
            {
              name: 'Issued',
              data: issuedData
            },
            {
              name: 'Forecasted',
              data: forecastedData
            }
          ],
          colors: ['#FF4560', '#008FFB'],
          xaxis: {
            type: 'datetime'
          },
          yaxis: {
            // 숫자가 커졌을 때 k, M, B 등으로 표시하도록 formatter 설정
            labels: {
              formatter: function (value) {
                if (value >= 1.0e9) {
                  // 10억 단위 (B)
                  return (value / 1.0e9).toFixed(2) + 'B';
                } else if (value >= 1.0e6) {
                  // 100만 단위 (M)
                  return (value / 1.0e6).toFixed(2) + 'M';
                } else if (value >= 1.0e3) {
                  // 1000 단위 (K)
                  return (value / 1.0e3).toFixed(1) + 'K';
                } else {
                  // 1000 이하이면 그대로 표시
                  return value.toFixed(2);
                }
              }
            }
          }
        };

        const chart = new ApexCharts(document.querySelector("#chart"), options);
        chart.render();
      })
      .catch(error => {
        console.error("JSON 데이터를 불러오는 중 오류 발생:", error);
      });
  </script>
</body>
</html>
